## 序列号：C3T03472206DA0072
```bash
#log路径
P:\temp\from simon.li\bug\2023-10-19\C3T03472206DA0072

18103: 10-18 21:18:24.150  1153  1153 E AndroidRuntime: Process: com.intellyva.camera, PID: 1153
18104: 10-18 21:18:24.150  1153  1153 E AndroidRuntime: java.lang.IllegalArgumentException: No Rect found
18105: 10-18 21:18:24.150  1153  1153 E AndroidRuntime:         at com.intellyva.camera.util.IconRectFactory.createIconRect(IconRectFactory.java:232)
18106: 10-18 21:18:24.150  1153  1153 E AndroidRuntime:         at com.intellyva.camera.customview.CropView.drawButtons(CropView.java:356)
18107: 10-18 21:18:24.150  1153  1153 E AndroidRuntime:         at com.intellyva.camera.customview.CropView.onDraw(CropView.java:318)
18108: 10-18 21:18:24.150  1153  1153 E AndroidRuntime:         at android.view.View.draw(View.java:22350)
18109: 10-18 21:18:24.150  1153  1153 E AndroidRuntime:         at android.view.View.updateDisplayListIfDirty(View.java:21226)
18110: 10-18 21:18:24.150  1153  1153 E AndroidRuntime:         at android.view.ViewGroup.recreateChildDisplayList(ViewGroup.java:4500)
18111: 10-18 21:18:24.150  1153  1153 E AndroidRuntime:         at android.view.ViewGroup.dispatchGetDisplayList(ViewGroup.java:4473)
18112: 10-18 21:18:24.150  1153  1153 E AndroidRuntime:         at android.view.View.updateDisplayListIfDirty(View.java:21186)
18113: 10-18 21:18:24.150  1153  1153 E AndroidRuntime:         at android.view.ViewGroup.recreateChildDisplayList(ViewGroup.java:4500)
18114: 10-18 21:18:24.150  1153  1153 E AndroidRuntime:         at android.view.ViewGroup.dispatchGetDisplayList(ViewGroup.java:4473)
18115: 10-18 21:18:24.150  1153  1153 E AndroidRuntime:         at android.view.View.updateDisplayListIfDirty(View.java:21186)
18116: 10-18 21:18:24.150  1153  1153 E AndroidRuntime:         at android.view.ThreadedRenderer.updateViewTreeDisplayList(ThreadedRenderer.java:559)
18117: 10-18 21:18:24.150  1153  1153 E AndroidRuntime:         at android.view.ThreadedRenderer.updateRootDisplayList(ThreadedRenderer.java:565)
18118: 10-18 21:18:24.150  1153  1153 E AndroidRuntime:         at android.view.ThreadedRenderer.draw(ThreadedRenderer.java:642)
18119: 10-18 21:18:24.150  1153  1153 E AndroidRuntime:         at android.view.ViewRootImpl.draw(ViewRootImpl.java:4106)
```

### 问题处理思路
首先搜索下面的 log ，观察 `imageSize` 是否为 `0x0` 。
```
onCropInfoChanged cropInfo:CropInfo{imageSize=0x0,
```

如果 `imageSize` 确认为 `0x0` ，则对于文件来说，就是 `getPreviewFileResolution()` 返回了 `0x0`，这里面分两种情况，一种是文件分辨率真的为空，另一种是虽然文件分辨率不为空，但是有不合法的字段，比如说当前 previewIndex 指向的文件是隐藏状态，即 visible = false，也会返回空。对于镜头来说，则是镜头的分辨率真的为空，这就要从获取镜头分辨率的方向去追查。

下面的log就是 resolution 不为空，但是 visible = false 的情况，这时 `getPreviewFileResolution()` 的结果也会是空。
```
Advertise{uuid=6e11506b-4d83-46a6-a201-140733fbeeec,	rect=RectF(0.08828647, 0.17420578, 0.5255252, 0.42015257),	zOrder=4,	previewIndex=0,	isVisible=true,	isFullScreen=false,	fileWrappers=[{file={fileId=ac9899ce-ffe1-4aa5-9ebc-1a7fa9512d3fpath=/storage/E47A4A977A4A6700/星计划宣传片/宣传片/屏幕1/2.2020车模大赛带 logo 高清电脑.mp4,	resolution=1920x1080,	size=133408348,	isExist=true,	bucketName=null,	objectName=null,	type=0,	md5=null},	visible=false}
```

确认是文件 visible = false 才引起的这个问题：首先选中一个视频信源，此时信源被框选，控制 ui 存在，然后到视频处隐藏该信源，此时控制 ui 没有消失，然后点击裁剪，就会发生崩溃。
### 解决方法
为确保裁剪模式的正常工作，在进入裁剪模式前，应该先对转换出来的 CropInfo 进行合法性检查。如果 CropInfo 不合法，则需要直接返回并中止进入裁剪模式的过程。
commit : [20488](http://intellyva:81/c/intellyva/apks/preview_camera/+/20488)

当信源已经非法时，例如 visible = false 的情况，应该隐藏控制界面，以防止用户对该非法信源进行操作。
commit : [21224](http://intellyva:81/c/intellyva/apks/liveplayer/+/21224)