## 功能概述
### 名词定义
|定义|解释|值|
|:---:|:---:|:---:|
|图层步长|两个图层间的间隔|1|

### 图层默认顺序
高 -> 低 
贴图 -> 镜头 -> 视频 -> 背景
图层越高值越大
### 添加图层
1. 优先寻找同类型信源，找到则在同类信源最大值的基础上 + 图层步长。
2. 无法找到同类型信源，则在图层默认顺序中找低于它类型的信源，找到则在其最大值基础上 + 图层步长。
3. 如仍未找到，则为它分配最低图层。
4. 如果出现图层计算结果已被其他信源占用，则被占用信源及其后的信源都要向后移动，保证新分配的图层正常插入。
#### 举例
1. 现有视频 = 1，USB = 2，贴图-1 = 3，贴图-2 = 4如果此时
   (1) 新增 HDMI1，则结果为
   视频 = 1，USB = 2，HDMI-1 = 3，贴图-1 = 4，贴图-2 = 5
   (2) 新增 贴图-3，则结果为
   视频 = 1，USB = 2，贴图-1 = 3，贴图-2 = 4，贴图-3 = 5

2. 现有背景 = 1，如果此时
   (1) 新增USB，则结果为 
   背景 = 1，USB = 4
   原因：由于背景支持图片和视频，渲染时会将图片和视频各占一层进行渲染，图片层 = 1，视频层 = 3，空闲层(应对后续变化) = 2，因此可以理解为背景存在时独占前三层，其他信源要从图层 = 4 开始。
### 删除图层
1. 把该信源图层值置为0
2. 重新分配现有信源图层，确保满足图层步长，不出现空层。
### 切换图层
1. 找到所有正在显示的信源
2. 判断当前操作的信源是否满足切换条件
3. 与其最接近的图层值做交换
#### 举例
1. 现有视频 = 1，USB = 2，贴图-1 = 3如果此时
   (1) USB 没有显示，贴图-1 下移一层，则结果为
   贴图-1 = 1，USB = 2，视频 = 3
   (2) USB 正在显示，贴图-1 下移一层，则结果为
   视频 = 1，贴图-1 = 2，USB = 3
### 复制图层
目前所有商品的信源共享一份图层取值，因此在新增商品时需要把上一个商品的图层值应用到该商品。
## 函数 Mapping
|功能|函数|
|---|---|
|添加图层|LayerManager.addLayer()|
|删除图层|LayerManager.removeLayer()|
|切换图层|LayerManager.layerUp()<br>LayerManager.layerDown()|
|获取图层最值(辅助函数)|LayerManager.getMaxLayer()<br>LayerManager.getMinLayer()|
|复制图层|LayerManager.copyLocalSourceLayer()|

## 后续需求
1. 每个商品有独立图层 ，即新增商品时不再复制商品图层。
## 文档版本
|版本|时间|
|---|---|
|V0.1|2023-09-22|